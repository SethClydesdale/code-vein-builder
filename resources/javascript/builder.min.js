!function(e,i){"use strict";if(e.CodeVeinBuilder={build:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],languages:{"0 - submit_translation":"submit","1 - English":"en","2 - 繁體中文":"zh-hant","3 - 日本語":"ja","4 - Français":"fr","5 - Deutsch":"de","6 - Italiano":"it","7 - 한국어":"ko","8 - Português":"pt-BR","9 - Русский":"ru","10 - Español - España":"es","11 - Español - Latinoamérica":"es-419"},cache:{buildList:i.getElementById("build-list"),buildDesc:i.getElementById("build-desc"),build:[i.getElementById("blood-code"),i.getElementById("weapon-1"),i.getElementById("weapon-2"),i.getElementById("blood-veil"),i.getElementById("transform-1"),i.getElementById("transform-2"),i.getElementById("transform-3"),i.getElementById("passive-1"),i.getElementById("passive-2"),i.getElementById("passive-3"),i.getElementById("passive-4"),i.getElementById("active-1"),i.getElementById("active-2"),i.getElementById("active-3"),i.getElementById("active-4"),i.getElementById("active-5"),i.getElementById("active-6"),i.getElementById("active-7"),i.getElementById("active-8")],infoColumn:{status:i.getElementById("status-info"),options:i.getElementById("options")},selector:{window:i.getElementById("selector-window"),box:i.getElementById("selector-box"),infoTop:i.getElementById("selector-info-top"),infoBottom:i.getElementById("selector-info-bottom")}},data:{order:{},dummy:{blood_code:{mobility:"none",weight:0,stats:{str:0,dex:0,mnd:0,wil:0,vit:0,for:0},ichor:{min:0,max:0}},equipment:{scaling:{str:0,dex:0,mnd:0,wil:0,vit:0,for:0}},active:{ichor_cost:0,cooldown:0,physical:0,elemental:0,usage_req:0}}},status:{stats:{str:0,dex:0,mnd:0,wil:0,vit:0,for:0},ichor:{min:0,max:0},weight:{weapon_1:0,transform_4:0,weapon_2:0,transform_5:0,blood_veil:0,transform_6:0,max:0,max_multiplier:0},values:["stats","ichor"],key:["-","E","E+","D","D+","C","C+","B","B+","A","A+","S","S+"],mobiKey:{none:-1},update:function(e){var i,a,o=0==e.type?"blood_code":1==e.type||2==e.type?"weapon":3==e.type?"blood_veil":4==e.type||5==e.type||6==e.type?"transform":"passive",l=0==e.id||e.oldId&&0!=e.oldId?CodeVeinBuilder.data[o][e.oldId]:null,t=0!=e.id?CodeVeinBuilder.data[o][e.id]:null,s=CodeVeinBuilder.status.values,d=s.length;if(l){if(/blood_code|passive/.test(o))for(i=0;i<d;i++)if(l[s[i]])for(a in l[s[i]])CodeVeinBuilder.status[s[i]][a]-=l[s[i]][a];switch(o){case"blood_code":CodeVeinBuilder.status.weight.max-=l.weight;break;case"weapon":CodeVeinBuilder.status.weight["weapon_"+e.type]-=l.weight;break;case"blood_veil":CodeVeinBuilder.status.weight.blood_veil-=l.weight;break;case"transform":(l.dec_weight||l.inc_weight)&&(CodeVeinBuilder.status.weight["transform_"+e.type]-=l.dec_weight?l.dec_weight:6==e.type?l.inc_weight.blood_veil:l.inc_weight.weapon);break;case"passive":"A19"==e.oldId&&(CodeVeinBuilder.status.weight.max_multiplier-=l.inc_max_weight)}}if(t){if(/blood_code|passive/.test(o))for(i=0;i<d;i++)if(t[s[i]])for(a in t[s[i]])CodeVeinBuilder.status[s[i]][a]+=t[s[i]][a];switch(o){case"blood_code":CodeVeinBuilder.status.weight.max+=t.weight;break;case"weapon":CodeVeinBuilder.status.weight["weapon_"+e.type]+=t.weight;break;case"blood_veil":CodeVeinBuilder.status.weight.blood_veil+=t.weight;break;case"transform":(t.dec_weight||t.inc_weight)&&(CodeVeinBuilder.status.weight["transform_"+e.type]+=t.dec_weight?t.dec_weight:6==e.type?t.inc_weight.blood_veil:t.inc_weight.weapon);break;case"passive":"A19"==e.id&&(CodeVeinBuilder.status.weight.max_multiplier+=t.inc_max_weight)}}},get:{weight:function(e,i){for(var a,o,l,t={},s=e||CodeVeinBuilder.status.weight,d=i||CodeVeinBuilder.data.blood_code[CodeVeinBuilder.build[0]],n=["max","weapon_1","weapon_2","blood_veil","total_1","total_2","mobility_1","mobility_2"],r=0,c=n.length;r<c;r++)if("max"==n[r])t[n[r]]=_parseVal(s.max*(s.max_multiplier||1));else if(/weapon_|blood_veil/.test(n[r]))a="blood_veil"==n[r]?6:+n[r].replace("weapon_","")+3,t[n[r]]=_parseVal("A0"==CodeVeinBuilder.build[a]?s[n[r]]/s["transform_"+a]:s[n[r]]*(s["transform_"+a]||1));else if(/total_/.test(n[r]))t[n[r]]=_parseVal(t["weapon_"+n[r].replace("total_","")]+t.blood_veil);else if(/mobility_/.test(n[r]))if(d)switch(o=t["total_"+n[r].replace("mobility_","")],l=t.max,CodeVeinBuilder.status.mobiKey[d.mobility]){case 0:t[n[r]]=o>l/2?_lang.mobi.slow:o<=l/2&&o>l/5?_lang.mobi.normal:_lang.mobi.quick;break;case 1:t[n[r]]=o>l?_lang.mobi.slow:o<=l&&o>l/2?_lang.mobi.normal:_lang.mobi.quick;break;case 2:t[n[r]]=o>1.35*l?_lang.mobi.slow:o<=1.35*l&&o>l?_lang.mobi.normal:_lang.mobi.quick}else t[n[r]]=_lang.na;return t}},display:function(){var e,i=CodeVeinBuilder.data.blood_code[CodeVeinBuilder.build[0]]||{name:"-",mobility:"-"},a="",o=CodeVeinBuilder.status.get.weight();for(e in CodeVeinBuilder.status.stats)a+='<div class="info-row"><span class="info-label"><span class="t-darker">'+e.toUpperCase()+"</span> "+_lang[e]+'</span><span class="info-value">'+CodeVeinBuilder.status.key[CodeVeinBuilder.status.stats[e]>12?12:CodeVeinBuilder.status.stats[e]]+"</span></div>";CodeVeinBuilder.cache.infoColumn.status.innerHTML='<div id="stats-window" class="ui-window"><div class="ui-title">'+_lang.status+'</div><div class="ui-window-inner"><div class="info-group"><div class="info-row"><span class="info-label">'+_lang.blood_code+'</span><span class="info-value">'+i.name+'</span></div><div class="info-row"><span class="info-label">'+_lang.ichor+'</span><span class="info-value">'+CodeVeinBuilder.status.ichor.min+" ("+CodeVeinBuilder.status.ichor.max+')</span></div><div class="info-row"><span class="info-label">'+_lang.mobi.base+'</span><span class="info-value">'+i.mobility+'</span></div></div><div class="info-group">'+a+'</div><div class="info-group"><div class="info-row"><span class="info-label">'+_lang.mobility+' 1</span><span class="info-value">'+o.mobility_1+" ("+o.total_1+"/"+o.max+')</span></div><div class="info-row"><span class="info-label">'+_lang.mobility+' 2</span><span class="info-value">'+o.mobility_2+" ("+o.total_2+"/"+o.max+")</span></div></div></div></div>"},check:{stats:function(e,i,a){if(CodeVeinBuilder.data[e][i]){var o,l=CodeVeinBuilder.build,t=CodeVeinBuilder.data[e][i].required,s=CodeVeinBuilder.data[e][i].blood_code_req,d=CodeVeinBuilder.data[e][i].weapon_req,n="",r="ui-stats-bad";if(s&&l[0]!=s&&(n=r),!d||0!=l[1]&&-1!=d.indexOf(l[1].charAt(0))||0!=l[2]&&-1!=d.indexOf(l[2].charAt(0))||(n=r),t&&n!=r)for(o in t)if((a||CodeVeinBuilder.status.stats)[o]<t[o]){n=r;break}return n}return""},equipped:function(){for(var e,i,a,o=[1,2,3,7,8,9,10,11,12,13,14,15,16,17,18],l=0,t=o.length;l<t;l++)e=CodeVeinBuilder.cache.build[o[l]],(i=CodeVeinBuilder.status.check.stats(e.dataset.type,e.dataset.id))&&!/ui-stats-bad/.test(e.className)?(e.className+=" "+i,a=!0):!i&&/ui-stats-bad/.test(e.className)&&(e.className=e.className.replace(" ui-stats-bad",""));a&&CodeVeinBuilder.alert.open(_lang.equip_error)}},reset:function(){for(var e,i=CodeVeinBuilder.status.values,a=0,o=i.length;a<o;a++)for(e in CodeVeinBuilder.status[i[a]])CodeVeinBuilder.status[i[a]][e]=0;for(a in CodeVeinBuilder.status.weight)CodeVeinBuilder.status.weight[a]=0}},alert:{isOpen:!1,open:function(a){CodeVeinBuilder.alert.isOpen&&CodeVeinBuilder.alert.close(!0);var o=i.createElement("DIV");o.id="cv-alert",o.className="alert-closed",o.innerHTML='<div id="cv-alert-body"><div id="cv-alert-icon" class="icon-glow"><i class="fa">&#xf05a;</i></div><div id="cv-alert-text"><p>'+a+"</p></div></div>",o.onclick=function(){CodeVeinBuilder.alert.close(!0)},i.body.appendChild(o),CodeVeinBuilder.cache.alert=o,CodeVeinBuilder.alert.isOpen=!0,e.setTimeout(function(){CodeVeinBuilder.alert.isOpen&&(CodeVeinBuilder.cache.alert.className="",CodeVeinBuilder.cache.alert.querySelector("#cv-alert-icon").className="")},150),CodeVeinBuilder.alert.timeout=e.setTimeout(CodeVeinBuilder.alert.close,4e3)},close:function(i){CodeVeinBuilder.alert.timeout&&(e.clearTimeout(CodeVeinBuilder.alert.timeout),delete CodeVeinBuilder.alert.timeout),i?CodeVeinBuilder.alert.remove():(CodeVeinBuilder.cache.alert.className="alert-closed",CodeVeinBuilder.cache.alert.style.opacity=0,CodeVeinBuilder.alert.closeTimeout=e.setTimeout(CodeVeinBuilder.alert.remove,500))},remove:function(){CodeVeinBuilder.alert.closeTimeout&&(e.clearTimeout(CodeVeinBuilder.alert.closeTimeout),delete CodeVeinBuilder.alert.closeTimeout),i.body.removeChild(CodeVeinBuilder.cache.alert),CodeVeinBuilder.alert.isOpen=!1}},scrollTo:function(e,a,o){"string"==typeof e&&(e=i.querySelector(e)),"string"==typeof a&&(a=i.querySelector(a)),o=o||0,(a||i.body).scrollTop=e.offsetTop+o,a||(i.documentElement.scrollTop=e.offsetTop+o)},selector:{isOpen:!1,activeCaller:null,open:function(e,a){for(var o,l,t,s,d=CodeVeinBuilder.cache.build[a],n="",r=1!=a&&2!=a&&3!=a||0==CodeVeinBuilder.build[a+3]?"":'<div class="ui-transform" style="background-image:url('+CodeVeinBuilder.getImage("transform",CodeVeinBuilder.build[a+3])+')"></div>',c='<div class="ui-block ui-'+e+'" data-type="remove" data-id="0" onmouseover="CodeVeinBuilder.selector.showInfo(this);" onclick="CodeVeinBuilder.selector.change(this, '+a+');" title="remove"></div>',u=0,p=CodeVeinBuilder.data.order[e].length;u<p;u++)s=CodeVeinBuilder.data.order[e][u],l=CodeVeinBuilder.selector.isEquipped(e,s,d.dataset.id),o=CodeVeinBuilder.status.check.stats(e,s),c+='<div class="ui-block ui-'+e+("transform"==e&&d.dataset.id==s?" ui-equipped ui-active-selection":l.className)+(o?" "+o:"")+'" data-type="'+e+'" data-id="'+s+'" '+l.slot+'style="background-image:url('+CodeVeinBuilder.getImage(e,s)+')" onmouseover="CodeVeinBuilder.selector.showInfo(this);" onclick="CodeVeinBuilder.selector.change(this, '+a+');" >'+r+"</div>";if(CodeVeinBuilder.selector.group[e]){n+='<div class="ui-title ui-groups ui-group-list-'+e+'">';for(s in CodeVeinBuilder.selector.group[e])n+='<span class="ui-group-option ui-group-'+CodeVeinBuilder.selector.group[e][s]+(0==s?" ui-group-active":"")+'" onclick="CodeVeinBuilder.selector.toggleGroup(\''+s+'\', this)" style="background-image:url('+CodeVeinBuilder.getImage("group",CodeVeinBuilder.selector.group[e][s])+')"></span>';n+="</div>"}CodeVeinBuilder.cache.selector.box.innerHTML=(n||'<div class="ui-title">'+_lang[e]+(/\d/.test(d.id)?d.id.replace(/.*?-(\d+)/," $1"):"")+"</div>")+'<div id="selector-options">'+c+"</div>",CodeVeinBuilder.selector.isOpen=!0,CodeVeinBuilder.selector.activeCaller=a,CodeVeinBuilder.cache.buildList.style.display="none",CodeVeinBuilder.cache.selector.window.style.display="",CodeVeinBuilder.scrollTo(CodeVeinBuilder.cache.selector.window,0,-5),CodeVeinBuilder.cache.selector.list=i.getElementById("selector-options"),CodeVeinBuilder.cache.selector.options=CodeVeinBuilder.cache.selector.list.querySelectorAll(".ui-block"),t=CodeVeinBuilder.cache.selector.list.querySelector('[data-id="'+(0==d.dataset.id?"A0":d.dataset.id)+'"]'),CodeVeinBuilder.selector.showInfo(t),CodeVeinBuilder.scrollTo(t,CodeVeinBuilder.cache.selector.list,"blood_code"==e?-85:-95)},close:function(){CodeVeinBuilder.selector.isOpen=!1,CodeVeinBuilder.selector.activeCaller=null,CodeVeinBuilder.cache.buildList.style.display="",CodeVeinBuilder.cache.selector.window.style.display="none"},isEquipped:function(e,i,a){var o,l,t,s={className:"",slot:""};if("transform"!=e){switch(e){case"blood_code":o=CodeVeinBuilder.cache.build.slice(0,1);break;case"weapon":o=CodeVeinBuilder.cache.build.slice(1,3);break;case"blood_veil":o=CodeVeinBuilder.cache.build.slice(3,4);break;case"passive":o=CodeVeinBuilder.cache.build.slice(7,11);break;case"active":o=CodeVeinBuilder.cache.build.slice(11,19)}for(l=0,t=o.length;l<t;l++)if(o[l].dataset.id==i){s.className=" ui-equipped"+(i==a?" ui-active-selection":""),s.slot='data-slot="'+CodeVeinBuilder.cache.build.indexOf(o[l])+'"';break}}return s},group:{weapon:{0:"all",A:"1h",B:"2h",C:"halberd",D:"hammer",E:"bayonet"},blood_veil:{0:"all",A:"ogre",B:"stinger",C:"hounds",D:"ivy"},passive:{0:"all",A:"buff",B:"def",C:"stats",D:"focus",E:"mastery",F:"misc"},active:{0:"all",A:"spell",B:"debuff",C:"buff",D:"def",E:"communal",F:"misc"}},toggleGroup:function(e,a){for(var o=i.querySelector(".ui-group-active"),l=CodeVeinBuilder.cache.selector.options,t=0,s=l.length;t<s;t++)0!=l[t].dataset.id&&(0==e||l[t].dataset.id.charAt(0)==e?l[t].style.display="":l[t].dataset.id.charAt(0)!=e&&(l[t].style.display="none"));for(o.className=o.className.replace(" ui-group-active",""),a.className+=" ui-group-active",t=0;t<s;t++)if("none"!=l[t].style.display&&0!=l[t].dataset.id){o=l[t];break}CodeVeinBuilder.selector.showInfo(o)},active:null,moveActive:function(e){var i=CodeVeinBuilder.selector.active,a=CodeVeinBuilder.cache.selector.list,o=i.dataset.type,l=!0;switch(e){case"left":for(;l;)"none"!=(i=i.previousSibling?i.previousSibling:a.lastChild).style.display&&(l=!1);CodeVeinBuilder.selector.showInfo(i),CodeVeinBuilder.scrollTo(i,a,"blood_code"==o?-85:-95);break;case"right":for(;l;)"none"!=(i=i.nextSibling?i.nextSibling:a.firstChild).style.display&&(l=!1);CodeVeinBuilder.selector.showInfo(i),CodeVeinBuilder.scrollTo(i,a,"blood_code"==o?-85:-95)}},showInfo:function(e){var i,a,o,l,t=e.dataset.type,s=e.dataset.id,d="";if(CodeVeinBuilder.selector.active&&(CodeVeinBuilder.selector.active.className=CodeVeinBuilder.selector.active.className.replace(" info-active","")),CodeVeinBuilder.selector.active=e,e.className+=" info-active",o=0==s?null:CodeVeinBuilder.data[t][s].origin,CodeVeinBuilder.cache.selector.infoTop.innerHTML=0==s?'<div class="'+e.className.replace(" info-active","")+'"></div><div class="item-info"><div class="item-title">'+_lang.remove+'</div><div class="hr"></div><div class="item-desc">'+_lang.remove_desc+"</div></div>":'<div class="'+e.className.replace(" info-active","")+'" style="background-image:url('+CodeVeinBuilder.getImage(t,s)+');"></div><div class="item-info"><div class="item-title">'+CodeVeinBuilder.data[t][s].name+(CodeVeinBuilder.data[t][s].dlc?' <span class="tag tag-dlc">'+_lang.dlc+"</span>":"")+'</div><div class="hr"></div>'+(CodeVeinBuilder.data[t][s].owner?'<div class="code-owner"><span class="t-darker">'+_lang.code_owner+"</span> "+CodeVeinBuilder.data[t][s].owner+"</div>":"")+(o?'<div class="gift-origin"><span class="t-darker">'+_lang.origin+"</span> "+(/^rvm|^cor/.test(o)?_lang["r"==o.charAt(0)?"rv_mastery":"companion_rank"]+" ("+o.slice(3)+")":CodeVeinBuilder.data.blood_code[o].name)+(CodeVeinBuilder.data[t][s].blood_code_req?' <span class="tag tag-exclusive" title="'+_lang.exclusive+'"><i class="fa">&#xf005;</i></span>':"")+"</div>":"")+'<div class="item-desc">'+CodeVeinBuilder.data[t][s].desc+"</div></div>",i=0==s?0:CodeVeinBuilder.data[t][CodeVeinBuilder.cache.build[CodeVeinBuilder.selector.activeCaller].dataset.id],"blood_code"==t){var n,r,c=CodeVeinBuilder.data[t][s];i=i||CodeVeinBuilder.data.dummy.blood_code,n=c.ichor.min>i.ichor.min?" stat-good":c.ichor.min<i.ichor.min?" stat-bad":"",v={current:CodeVeinBuilder.status.mobiKey[i.mobility],hover:CodeVeinBuilder.status.mobiKey[c.mobility]},r={current:_parseVal(i.weight*(CodeVeinBuilder.status.weight.max_multiplier||1)),hover:_parseVal(c.weight*(CodeVeinBuilder.status.weight.max_multiplier||1))},d+='<div class="info-group"><div class="info-row"><span class="info-label">'+_lang.ichor+'</span><span class="info-value">'+c.ichor.min+" ("+c.ichor.max+")"+(n?' <span class="'+n+'">('+(" stat-good"==n?"+":"-")+Math.abs(c.ichor.min-i.ichor.min)+")":"")+'</span></span></div><div class="info-row"><span class="info-label">'+_lang.mobi.base+'</span><span class="info-value'+(v.hover>v.current?" stat-good":v.hover<v.current?" stat-bad":"")+'">'+c.mobility+'</span></div><div class="info-row"><span class="info-label">'+_lang.weight_limit+'</span><span class="info-value">'+r.hover+(r.hover==r.current?"":' <span class="'+(r.hover>r.current?"stat-good":r.hover<r.current?"stat-bad":"")+'">('+(r.hover>r.current?"+":r.hover<r.current?"-":"")+_parseVal(Math.abs(r.hover-r.current))+")</span>")+'</span></div></div><div class="info-group">';for(l in c.stats)a=c.stats[l],d+='<div class="info-row"><span class="info-label"><span class="t-darker">'+l.toUpperCase()+"</span> "+_lang[l]+'</span><span class="info-value'+(a>i.stats[l]?" stat-good":a<i.stats[l]?" stat-bad":"")+'">'+CodeVeinBuilder.status.key[a>12?12:a]+"</span></div>";d+="</div>";var u=CodeVeinBuilder.status.get.weight(),p={};for(l in CodeVeinBuilder.status.weight)p[l]="max"==l?c.weight:CodeVeinBuilder.status.weight[l];p=CodeVeinBuilder.status.get.weight(p,c),v={current:[CodeVeinBuilder.status.mobiKey[u.mobility_1],CodeVeinBuilder.status.mobiKey[u.mobility_2]],hover:[CodeVeinBuilder.status.mobiKey[p.mobility_1],CodeVeinBuilder.status.mobiKey[p.mobility_2]]},d+='<div class="info-group"><div class="info-row"><span class="info-label">'+_lang.mobility+' 1</span><span class="info-value"><span class="'+(v.hover[0]>v.current[0]?"stat-good":v.hover[0]<v.current[0]?"stat-bad":"")+'">'+p.mobility_1+"</span> ("+u.total_1+"/"+p.max+')</span></div><div class="info-row"><span class="info-label">'+_lang.mobility+' 2</span><span class="info-value"><span class="'+(v.hover[1]>v.current[1]?"stat-good":v.hover[1]<v.current[1]?"stat-bad":"")+'">'+p.mobility_2+"</span> ("+u.total_2+"/"+p.max+")</span></div></div>"}else if(/weapon|blood_veil/.test(t)){i=i?i.scaling:CodeVeinBuilder.data.dummy.equipment.scaling,d+='<div class="info-group"><div class="info-group-title">'+_lang.stat_scaling+"</div>";for(l in CodeVeinBuilder.status.stats)a=CodeVeinBuilder.data[t][s].scaling[l],d+='<div class="info-row"><span class="info-label"><span class="t-darker">'+l.toUpperCase()+"</span> "+_lang[l]+'</span><span class="info-value'+(a>i[l]?" stat-good":a<i[l]?" stat-bad":"")+'">'+CodeVeinBuilder.status.key[a>12?12:a]+"</span></div>";if(d+="</div>",CodeVeinBuilder.data[t][s].required){d+='<div class="info-group required-stats"><div class="info-group-title">'+_lang.required_stats+"</div>";for(l in CodeVeinBuilder.data[t][s].required)a=CodeVeinBuilder.data[t][s].required[l],d+='<div class="info-row"><span class="info-label"><span class="t-darker">'+l.toUpperCase()+"</span> "+_lang[l]+'</span><span class="info-value'+(CodeVeinBuilder.status.stats[l]<a?" stat-bad":"")+'">'+CodeVeinBuilder.status.key[a>12?12:a]+"</span></div>";d+="</div>";var v,g,f,b=CodeVeinBuilder.selector.activeCaller;u=CodeVeinBuilder.status.get.weight(),p={};for(l in CodeVeinBuilder.status.weight)p[l]="weapon_1"==l&&1==b||"weapon_2"==l&&2==b||"blood_veil"==l&&3==b?CodeVeinBuilder.data[t][s].weight:CodeVeinBuilder.status.weight[l];p=CodeVeinBuilder.status.get.weight(p),v={current:[CodeVeinBuilder.status.mobiKey[u.mobility_1],CodeVeinBuilder.status.mobiKey[u.mobility_2]],hover:[CodeVeinBuilder.status.mobiKey[p.mobility_1],CodeVeinBuilder.status.mobiKey[p.mobility_2]]},g=1==b?u.weapon_1:2==b?u.weapon_2:u.blood_veil,f=1==b?p.weapon_1:2==b?p.weapon_2:p.blood_veil,d+='<div class="info-group"><div class="info-row"><span class="info-label">'+_lang.weight+'</span><span class="info-value">'+f+(f==g?"":' <span class="'+(f>g?"stat-bad":f<g?"stat-good":"")+'">('+(f>g?"+":f<g?"-":"")+_parseVal(Math.abs(g-f))+")</span>")+"</span></div>"+(1==b||3==b?'<div class="info-row"><span class="info-label">'+_lang.mobility+' 1</span><span class="info-value"><span class="'+(v.hover[0]>v.current[0]?"stat-good":v.hover[0]<v.current[0]?"stat-bad":"")+'">'+p.mobility_1+"</span> ("+p.total_1+"/"+p.max+")</span></div>":"")+(2==b||3==b?'<div class="info-row"><span class="info-label">'+_lang.mobility+' 2</span><span class="info-value"><span class="'+(v.hover[1]>v.current[1]?"stat-good":v.hover[1]<v.current[1]?"stat-bad":"")+'">'+p.mobility_2+"</span> ("+p.total_2+"/"+p.max+")</span></div>":"")+"</div>"}}else if("passive"==t){var B=CodeVeinBuilder.data[t][s];d+='<div class="info-row"><span class="info-sub-group"><span class="info-label">'+_lang.tree.title+'</span><span class="info-value">'+B.tree+'</span></span><span class="info-sub-group"><span class="info-label">'+_lang.gift_type+'</span><span class="info-value">'+_lang.passive+'</span></span></div><div class="hr"></div>'+(B.usage_req?'<div class="skill-info-list"><div class="info-row"><span class="info-label">'+_lang.usage_req+'</span><span class="info-value'+(B.blood_code_req&&CodeVeinBuilder.build[0]!=B.blood_code_req?" stat-bad":"")+'">'+B.usage_req+'</span></div></div><div class="hr"></div>':"")+'<div class="info-group"><div class="info-group-title"><span class="t-darker">'+_lang.required_stats+'</span></div><div class="info-row"><span class="info-label no-value">'+_lang.none+"</span></div></div>"}else if("active"==t){var m,C=CodeVeinBuilder.data[t][s],V="";if(C.weapon_req)for(m in CodeVeinBuilder.selector.group.weapon)0!=m&&(V+='<img src="'+CodeVeinBuilder.getImage("group",CodeVeinBuilder.selector.group.weapon[m])+'" class="weapon-'+(-1!=C.weapon_req.indexOf(m)?"valid":"invalid")+'" title="'+_lang[CodeVeinBuilder.selector.group.weapon[m]]+'">');d+='<div class="info-row"><span class="info-sub-group"><span class="info-label">'+_lang.tree.title+'</span><span class="info-value">'+CodeVeinBuilder.data[t][s].tree+(V?'<span class="weapon-requirement">'+V+"</span>":"")+'</span></span><span class="info-sub-group"><span class="info-label">'+_lang.gift_type+'</span><span class="info-value">'+_lang.active+'</span></span></div><div class="hr"></div>',d+='<div class="skill-info-list">';for(l in CodeVeinBuilder.data.dummy.active)d+='<div class="info-row"><span class="info-label">'+_lang[l]+'</span><span class="info-value'+("usage_req"==l&&C.blood_code_req&&CodeVeinBuilder.build[0]!=C.blood_code_req?" stat-bad":"")+'">'+(C[l]?C[l]+("cooldown"==l?" "+_lang.seconds:""):"-")+"</span></div>";if(d+='</div><div class="hr"></div>',d+='<div class="info-group skill-info-list"><div class="info-group-title"><span class="t-darker">'+_lang.required_stats+"</span></div>",C.required){for(l in C.required)a=C.required[l],d+='<div class="info-row"><span class="info-label"><span class="t-darker">'+l.toUpperCase()+"</span> "+_lang[l]+'</span><span class="info-value'+(CodeVeinBuilder.status.stats[l]<a?" stat-bad":"")+'">'+CodeVeinBuilder.status.key[a>12?12:a]+"</span></div>";d+="</div>"}else d+='<div class="info-row"><span class="info-label no-value">'+_lang.none+"</span></div></div>"}CodeVeinBuilder.cache.selector.infoBottom.innerHTML="transform"==t||0==s?"":'<div class="ui-window-inner'+(/active|passive/.test(t)?" skill-info":/weapon|blood_/.test(t)?" status-info":"")+'">'+d+"</div>"},change:function(e,i){var a,o,l=e.dataset.type,t=e.dataset.id,s=CodeVeinBuilder.cache.build[i],d=s.dataset.id;!{0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1}[i]||e.dataset.slot&&!{1:1,2:1}[i]||t==d||(CodeVeinBuilder.status.update({type:i,id:t,oldId:d}),e.dataset.slot&&{1:1,2:1}[i]&&CodeVeinBuilder.status.update({type:1==i?2:1,id:d,oldId:t}),a=!0),e.dataset.slot&&!/ui-active-selection/.test(e.className)&&(o=CodeVeinBuilder.cache.build[e.dataset.slot],d=s.dataset.id,CodeVeinBuilder.build[e.dataset.slot]=d,o.dataset.id=d,o.style.backgroundImage=s.style.backgroundImage?"url("+CodeVeinBuilder.getImage(l,d)+")":""),CodeVeinBuilder.build[i]=t,s.dataset.id=t,s.style.backgroundImage="remove"==l?"":"url("+CodeVeinBuilder.getImage(l,t)+")",a&&CodeVeinBuilder.status.display(),CodeVeinBuilder.status.check.equipped(),CodeVeinBuilder.selector.close(),t!=d&&(CodeVeinBuilder.updateURL(),CodeVeinBuilder.cache.buildDesc.firstChild&&CodeVeinBuilder.updateDesc(0))}},loadBuild:function(){for(var i,a,o,l,t=e.location.search.slice(1).split("&"),s=0,d=t.length;s<d;s++)if(i=t[s].split("="),/build/i.test(i[0])){a=LZString.decompressFromEncodedURIComponent(i[1]).split("|"),CodeVeinBuilder.build=a;for(var n,r,c=0,u=a.length;c<u;c++)r=(n=CodeVeinBuilder.cache.build[c]).dataset.type,n.dataset.id=a[c],n.style.backgroundImage=0==a[c]?"":"url("+CodeVeinBuilder.getImage(r,a[c])+")",0!=a[c]&&/blood_code|passive|weapon|blood_veil|transform/.test(r)&&CodeVeinBuilder.status.update({type:c,id:a[c]})}else if(/context/i.test(i[0]))try{o=LZString.decompressFromEncodedURIComponent(i[1]).replace(/^\d+ - /,"").split("|"),l=CodeVeinBuilder.presets[o[0]][o[1]],CodeVeinBuilder.updateDesc({title:o[1],desc:l[1],author:l[2]?l[2].split("|"):""})}catch(e){console.error(e),CodeVeinBuilder.updateDesc(0)}!o&&CodeVeinBuilder.cache.buildDesc.firstChild&&CodeVeinBuilder.updateDesc(0),CodeVeinBuilder.status.display(),CodeVeinBuilder.status.check.equipped()},randBuild:function(){for(var e,i,a,o=0,l=CodeVeinBuilder.build.length,t={weapon:[],passive:[],active:[]};o<l;o++)if(0==o)CodeVeinBuilder.build[o]=_randKey(CodeVeinBuilder.data.blood_code),i=CodeVeinBuilder.data.blood_code[CodeVeinBuilder.build[0]].stats;else if(1==o||2==o){for(;;)if(e=_randKey(CodeVeinBuilder.data.weapon),-1==t.weapon.indexOf(e)&&""==CodeVeinBuilder.status.check.stats("weapon",e,i)){CodeVeinBuilder.build[o]=e,t.weapon.push(e);break}}else if(3==o){for(;;)if(e=_randKey(CodeVeinBuilder.data.blood_veil),""==CodeVeinBuilder.status.check.stats("blood_veil",e,i)){CodeVeinBuilder.build[o]=e;break}}else if(4==o||5==o||6==o)CodeVeinBuilder.build[o]=0==Math.floor(2*Math.random())?0:_randKey(CodeVeinBuilder.data.transform);else if(7==o||8==o||9==o||10==o){for(;;)if(e=_randKey(CodeVeinBuilder.data.passive),a=CodeVeinBuilder.data.passive[e].blood_code_req,-1==t.passive.indexOf(e)&&(!a||a==CodeVeinBuilder.build[0])){CodeVeinBuilder.build[o]=e,t.passive.push(e);break}}else if(11==o||12==o||13==o||14==o||15==o||16==o||17==o||18==o)for(;;)if(e=_randKey(CodeVeinBuilder.data.active),a=CodeVeinBuilder.data.active[e].blood_code_req,-1==t.active.indexOf(e)&&""==CodeVeinBuilder.status.check.stats("active",e,i)&&(!a||a==CodeVeinBuilder.build[0])){CodeVeinBuilder.build[o]=e,t.active.push(e);break}},updateURL:function(a){if(e.history&&e.history.pushState){var o="";(/lang=/i.test(e.location.search)||e.localStorage&&localStorage.cvbLang)&&(o=/lang=/i.test(e.location.search)?e.location.search.match(/lang=.*?(?:&|$)/i):"lang="+localStorage.cvbLang)&&o[0]&&(o="&"+(/lang=/i.test(e.location.search)?o[0]:o)),e.history.pushState({},i.title,e.location.href.replace(e.location.search,"")+"?build="+LZString.compressToEncodedURIComponent(CodeVeinBuilder.build.join("|"))+(/devmode=true/i.test(e.location.search)?"&devmode=true":"")+o+(a?"&context="+LZString.compressToEncodedURIComponent(a.join("|")):""))}},updateDesc:function(e){if(e){var i=/u\//.test(e.author[0]);CodeVeinBuilder.cache.buildDesc.innerHTML='<div class="ui-window"><div class="ui-title">'+e.title+'</div><div class="ui-window-inner"><div class="info-group">'+(e.author[0]?'<div class="info-row"><div class="info-label">'+_lang.preset_author+'</div><div class="info-value"><a href="'+(i?"https://reddit.com/":"https://github.com/")+e.author[0]+'" target="_blank">'+e.author[0]+"</a></div></div>":"")+(e.author[1]?'<div class="info-row"><div class="info-label">'+_lang.preset_origin+'</div><div class="info-value"><a href="'+(i?"https://reddit.com/r/codevein/comments/dyrpbu/c/":"https://github.com/SethClydesdale/code-vein-builder/issues/")+e.author[1]+'" target="_blank">'+(i?"reddit":"github")+"</a></div></div>":"")+(e.desc?'<div class="info-row"><div class="info-label">'+_lang.preset_desc+'</div><div class="info-value">'+e.desc+"</div></div>":"")+"</div></div></div>"}else CodeVeinBuilder.cache.buildDesc.innerHTML=""},getImage:function(e,i){if("group"==e||CodeVeinBuilder.data[e][i])return"resources/images/"+e+"/"+("group"==e?i:CodeVeinBuilder.data[e][i].image)+".png";console.error('getImage Error: id "'+i+'" of type "'+e+'" was not found.')},preset:{change:function(i){var a=i.options[i.selectedIndex];if("default"!=a.value){if("submit"==a.value)return void GenkiModal.open({title:a.innerHTML,content:_lang.preset_submit_confirm,callback:function(){var i="file:"==e.location.protocol,a=e.location.href.replace(/\?.*?$/,"");e.location.href=i?a.replace("index.html","submit-build/index.html"):a+"submit-build/"},close:function(){i.selectedIndex=0}});e.localStorage&&"true"==localStorage.noPresetWarning?CodeVeinBuilder.preset.load(i,a):GenkiModal.open({title:_lang.preset_windows,content:_lang.preset_warn.replace("%{PRESET_NAME}",a.innerHTML)+'<div class="checkbox-zone"><label for="preset_warning"><input id="preset_warning" type="checkbox" onchange="localStorage.noPresetWarning = this.checked;"> '+_lang.preset_stop_warning+"</label></div>",callback:function(){CodeVeinBuilder.preset.load(i,a)},close:function(){i.selectedIndex=0}})}},load:function(e,i){var a=i.dataset.group?[i.dataset.group,i.innerHTML]:null,o=a?CodeVeinBuilder.presets[a[0]][a[1]]:"";"random"==i.value?CodeVeinBuilder.randBuild():CodeVeinBuilder.build=LZString.decompressFromEncodedURIComponent(i.value).split("|"),"string"!=typeof o?(CodeVeinBuilder.updateURL(a),CodeVeinBuilder.updateDesc({title:a[1],desc:o[1],author:o[2]?o[2].split("|"):""})):(CodeVeinBuilder.updateURL(),CodeVeinBuilder.updateDesc(0)),CodeVeinBuilder.status.reset(),CodeVeinBuilder.loadBuild(),CodeVeinBuilder.scrollTo("#build-list"),e.selectedIndex=0}},changeLanguage:function(a){var o,l,t=a.options[a.selectedIndex].value;"submit"!=t?("en"!=t?/lang=/i.test(e.location.search)?e.location.search=e.location.search.replace(/lang=.*?(?:&|$)/i,"lang="+t):/build=/i.test(e.location.search)?e.location.search=e.location.search+"&lang="+t:e.location.search="?lang="+t:e.location.href=e.location.href.replace(/(&|\?|)lang=.*?(?:&|$)/,""),e.localStorage&&(e.localStorage.cvbLang=t)):GenkiModal.open({title:a.options[a.selectedIndex].innerHTML,content:_lang.submit_translation_confirm,callback:function(){o="file:"==e.location.protocol,l=e.location.href.replace(/\?.*?$/,""),e.location.href=o?l.replace("index.html","translate/index.html"):l+"translate/"},close:function(){a.selectedIndex=i.getElementById("default-selected").index}})},code:{save:function(){GenkiModal.open({title:_lang.save_build,content:'<div class="info-group">'+_lang.save_build_desc+'</div><div class="share-build-options"><div class="info-group"><div class="info-label"><button class="button copy-button" data-clipboard-target="#copy-url" data-success="'+_lang.copy_success+'" data-original="'+_lang.copy_url+'">'+_lang.copy_url+'</button></div><div class="info-value"><input type="text" id="copy-url" value="'+("file:"==e.location.protocol?"https://sethclydesdale.github.io/code-vein-builder/"+e.location.search:e.location.href)+'"></div></div><div><div class="info-label"><button class="button copy-button" data-clipboard-target="#copy-code" data-success="'+_lang.copy_success+'" data-original="'+_lang.copy_code+'">'+_lang.copy_code+'</button></div><div class="info-value"><input type="text" id="copy-code" value="'+LZString.compressToEncodedURIComponent(CodeVeinBuilder.build.join("|"))+'"></div></div></div>',noFocus:1})},load:function(){GenkiModal.open({title:_lang.load_build,content:'<div class="info-group">'+_lang.load_build_desc+'</div><div class="share-build-options load-build"><div class="info-label">'+_lang.load_build_label+'</div><div class="info-value"><input type="text" id="build_code"></div></div>',buttonText:_lang.load_build,focus:"#build_code",keepOpen:1,callback:function(){var e,a=i.getElementById("build_code").value;if(!a)return alert(_lang.load_build_error);/build=/i.test(a)&&(e=a.match(/context=(.*?)(?:&|$)/i),(a=a.match(/build=(.*?)(?:&|$)/i))&&a[1]&&(a=a[1]),e&&e[1]&&(e=e[1]));try{CodeVeinBuilder.build=LZString.decompressFromEncodedURIComponent(a).split("|"),CodeVeinBuilder.updateURL(e?LZString.decompressFromEncodedURIComponent(e).split("|"):""),CodeVeinBuilder.status.reset(),CodeVeinBuilder.loadBuild(),GenkiModal.close(),CodeVeinBuilder.scrollTo("#build-list")}catch(e){alert(e)}}})}},setupData:function(a){var o=i.createElement("SCRIPT");o.src="resources/lang/"+a+"/lang"+(/devmode=true/i.test(e.location.search)?"":".min")+".js",o.onload=function(){(o=i.createElement("SCRIPT")).src="resources/javascript/data.min.js",o.onload=function(){(o=i.createElement("SCRIPT")).src="resources/javascript/presets.min.js",o.onload=function(){CodeVeinBuilder.init(a)},i.body.appendChild(o)},i.body.appendChild(o),i.body.className+=" lang-"+a,i.documentElement.lang=a},o.onerror=function(){CodeVeinBuilder.setupData("en")},i.body.appendChild(o)},init:function(a){/build=/i.test(e.location.search)?(CodeVeinBuilder.loadBuild(),CodeVeinBuilder.scrollTo("#build-list")):/^\?random/.test(e.location.search)?(CodeVeinBuilder.randBuild(),CodeVeinBuilder.updateURL(),CodeVeinBuilder.loadBuild(),CodeVeinBuilder.scrollTo("#build-list")):CodeVeinBuilder.status.display();var o,l,t,s,d,n="",r='<option value="default" selected>'+_lang.preset_default+'</option><option value="submit">'+_lang.preset_submit+'</option><optgroup label="'+_lang.preset_group.initial+'"><option value="AwH17SOrZ4g">'+_lang.preset_empty+'</option><option value="random">'+_lang.preset_random+"</option></optgroup>";for(t in CodeVeinBuilder.languages)o=t.replace(/^\d+ - /,""),n+='<option value="'+CodeVeinBuilder.languages[t]+'"'+(a&&a==CodeVeinBuilder.languages[t]||!a&&"en"==CodeVeinBuilder.languages[t]?' id="default-selected" selected':"")+">"+("submit_translation"==o?_lang[o]:o)+"</option>";for(t=0,s=CodeVeinBuilder.presetsOrder.length;t<s;t++){o=CodeVeinBuilder.presetsOrder[t],l=CodeVeinBuilder.presets[o],r+='<optgroup label="'+_lang.preset_group[o]+'">';for(d in l)r+='<option value="'+("string"==typeof l[d]?l[d]:l[d][0])+'" data-group="'+o+'">'+d+"</option>";r+="</optgroup>"}CodeVeinBuilder.cache.infoColumn.options.innerHTML='<div class="ui-window"><div class="ui-title">'+_lang.options+'</div><div class="ui-window-inner"><div class="info-group center"><div class="info-row"><button class="button" onclick="CodeVeinBuilder.code.save();"><i class="fa">&#xf0c7;</i>'+_lang.save_build+'</button><button class="button" onclick="CodeVeinBuilder.code.load();"><i class="fa">&#xf019;</i>'+_lang.load_build+'</button></div><div class="info-row"><select onchange="CodeVeinBuilder.preset.change(this);">'+r+'</select></div></div><div class="info-group"><div class="info-row"><div class="info-label">'+_lang.lang_select+'</div><div class="info-value"><select onchange="CodeVeinBuilder.changeLanguage(this);">'+n+"</select></div></div></div></div></div>",e.onpopstate=function(){/build=/i.test(e.location.search)&&(CodeVeinBuilder.status.reset(),CodeVeinBuilder.loadBuild(),CodeVeinBuilder.selector.isOpen&&CodeVeinBuilder.selector.close(),GenkiModal.isOpen&&GenkiModal.close())},new ClipboardJS(".copy-button").on("success",function(i){var a=i.trigger;a.innerHTML!=a.dataset.success&&(a.innerHTML=a.dataset.success,e.setTimeout(function(){a.innerHTML=a.dataset.original},1e3))}),i.onkeydown=function(e){if(CodeVeinBuilder.selector.isOpen)switch(e.key){case"Left":case"ArrowLeft":CodeVeinBuilder.selector.moveActive("left"),e.preventDefault();break;case"Right":case"ArrowRight":CodeVeinBuilder.selector.moveActive("right"),e.preventDefault();break;case"Spacebar":case" ":var a=i.querySelector(".ui-group-active");a&&(a.nextSibling?a.nextSibling.click():i.querySelector(".ui-group-all").click()),e.preventDefault();break;case"Enter":CodeVeinBuilder.selector.change(CodeVeinBuilder.selector.active,CodeVeinBuilder.selector.activeCaller),e.preventDefault();break;case"Esc":case"Escape":CodeVeinBuilder.selector.close(),e.preventDefault();break;case"Up":case"ArrowUp":e.preventDefault();break;case"Down":case"ArrowDown":e.preventDefault()}}}},/lang=/i.test(e.location.search)||e.localStorage&&"en"!=localStorage.cvbLang){var a=/lang=/i.test(e.location.search)?e.location.search.match(/lang=(.*?)(?:&|$)/i):localStorage.cvbLang;a&&a[1]?CodeVeinBuilder.setupData((/lang=/i.test(e.location.search)?a[1]:a).toLowerCase()):CodeVeinBuilder.setupData("en")}else CodeVeinBuilder.setupData("en")}(window,document);